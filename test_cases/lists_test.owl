module lists_test {

  fn test_nth() {
    let int_list = [1, 2, 3]
    owl_unit:assert_eq(list:nth(int_list, 2), 3)
    owl_unit:assert_eq(list:nth(int_list, 15), nil)

    let str_list = ["one", "two", "three"]
    owl_unit:assert_eq(list:nth(str_list, 1), "two")
    owl_unit:assert_eq(list:nth(str_list, 99), nil)
  }

  fn test_count() {
    let int_list = [1, 2, 3]
    owl_unit:assert_eq(list:count(int_list), 3)

    let str_list = ["one"]
    owl_unit:assert_eq(list:count(str_list), 1)
  }

  fn test_first() {
    owl_unit:assert_eq(list:first([1, 2]), 1)
    owl_unit:assert_eq(list:first(["one"]), "one")
    owl_unit:assert_eq(list:first([]), nil)
  }

  fn main() {
    owl_unit:assert_eq([1, 2], [1, 2])
    owl_unit:refute_eq([1, 2], [9, 10])

    owl_unit:assert_eq(["one", "two"], ["one", "two"])
    owl_unit:refute_eq(["one", "two"], ["one", "not two"])

    test_nth()
    test_count()
    test_first()
  }
}
